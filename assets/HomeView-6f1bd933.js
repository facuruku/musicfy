import{m as u,u as m,a as C,f as q,R as L,_ as k,r as S,o as a,c,b as e,n as g,t as i,w as x,d as _,e as b,g as D,h as j,i as B,j as R,F as E,k as H,l as P,p as z,s as y,q as p,v as N}from"./index-c5ab9c48.js";const U="/musicfy/assets/img/equaliser-animated-green.gif",V={name:"SongItem",props:{song:{type:Object,required:!0},index:{type:Number,required:!0},isSelected:{type:Boolean,required:!0}},emits:["double-click"],computed:{...u(m,["getCurrentSong","isPlaying"]),isSongInPlayer(){return this.getCurrentSong.docID===this.song.docID},isSongPlaying(){return this.isSongInPlayer&&this.isPlaying}},methods:{...C(m,["play","toggleAudio"]),getDuration(){return q(this.song.duration??0)},handleDblClick(t){this.$emit("double-click"),this.play(t)}},components:{RouterLink:L}},M={class:"flex justify-center items-center"},O={key:0,class:"group-hover:hidden"},$={key:1,src:U,alt:"Sound wave",class:"group-hover:hidden w-3.5"},F={class:"overflow-x-clip text-ellipsis"},T=["onClick"],W={class:"flex justify-end items-center gap-4"},G=e("i",{class:"!hidden sm:!block fa-solid fa-heart text-green-500"},null,-1),J={class:"hidden sm:block w-9"};function K(t,n,s,f,h,o){const r=S("RouterLink");return a(),c("tr",{class:g(["group hover:cursor-pointer",{"bg-white bg-opacity-30 ":s.isSelected,"sm:hover:bg-white sm:hover:bg-opacity-10 sm:hover:text-white secondary-text":!s.isSelected}])},[e("td",{id:"index",class:g(["hidden sm:table-cell rounded-l-md",{"text-green-500":o.isSongInPlayer,"text-secondary":!o.isSongInPlayer}]),onClick:n[0]||(n[0]=x(l=>o.isSongInPlayer?t.toggleAudio():t.play(s.song),["prevent"]))},[e("div",M,[e("i",{class:g(["!hidden group-hover:!block fa-solid text-white text-sm",{"fa-pause ":o.isSongPlaying,"fa-play":!o.isSongPlaying}])},null,2),o.isSongPlaying?(a(),c("img",$)):(a(),c("p",O,i(s.index+1),1))])],2),e("td",{id:"title",onDblclick:n[1]||(n[1]=l=>o.handleDblClick(s.song)),class:"rounded-l-md sm:rounded-none px-2"},[_(r,{to:{name:"song",params:{id:s.song.docID}},class:"text-white w-max border-b border-b-transparent hover:border-b-white"},{default:b(()=>[e("span",{class:g(["overflow-x-clip text-ellipsis",{"text-white":!o.isSongInPlayer,"text-green-500":o.isSongInPlayer}])},i(s.song.modified_name),3)]),_:1},8,["to"]),_(r,{to:{name:"song",params:{id:s.song.docID}},class:"block w-max border-b border-b-transparent hover:border-b-white text-sm"},{default:b(()=>[e("span",F,i(s.song.artist||t.$t("home.unknown")),1)]),_:1},8,["to"])],32),e("td",{id:"genre",onDblclick:n[2]||(n[2]=l=>o.handleDblClick(s.song)),class:"hidden sm:table-cell"},i(s.song.genre||t.$t("home.unknown")),33),e("td",{id:"comments",onDblclick:n[3]||(n[3]=l=>o.handleDblClick(s.song)),class:"hidden sm:table-cell"},[_(r,{custom:"",to:{name:"song",params:{id:s.song.docID},hash:"#comments"}},{default:b(({navigate:l})=>[e("span",{onClick:l,class:"hover:underline"},i(s.song.comment_count),9,T)]),_:1},8,["to"])],32),e("td",{id:"duration",onDblclick:n[5]||(n[5]=l=>o.handleDblClick(s.song)),class:"rounded-r-md px-2"},[e("div",W,[G,e("i",{class:g(["sm:!hidden fa-solid text-white text-xl",{"fa-pause":o.isSongPlaying,"fa-play":!o.isSongPlaying}]),onClick:n[4]||(n[4]=x(l=>o.isSongInPlayer?t.toggleAudio():t.play(s.song),["prevent"]))},null,2),e("p",J,i(o.getDuration()),1)])],32)],2)}const Q=k(V,[["render",K]]),w="/musicfy/assets/img/liked-songs-300.webp",v="/musicfy/assets/img/liked-songs-640.webp",X={name:"AppPlaylist",components:{SongItem:Q},props:{songs:{type:Array,required:!0},songsCount:{type:Number,required:!0}},data(){return{selectedSong:""}},computed:{...u(m,["playing","playerHasSong"]),...u(D,["username"])},methods:{...C(m,["play","toggleAudio"]),greeting(){return j()},isSongSelected(t){return this.selectedSong===t},selectSong(t){this.selectedSong=this.selectedSong===t?null:t},handleDblClick(t){this.selectSong(t.docID),this.play(t)}}},Y=w+" 150w, "+w+" 300w, "+v+" 320w, "+v+" 640w",Z={class:"flex flex-col"},ee={class:"px-4 pb-5 text-white font-circular-thin bg-gradient-1"},te={class:"pt-10 pb-10 font-circular-black text-xl sm:text-2xl lg:text-4xl"},se={class:"container flex justify-between items-end sm:gap-6"},ne=e("img",{"aria-hidden":"false",draggable:"false",loading:"eager",src:w,alt:"Liked songs",class:"shadow-3xl order-2 sm:order-1 w-28 h-28 sm:w-max sm:h-max",srcset:Y,sizes:"(min-width: 1280px) 232px, 192px"},null,-1),oe={class:"text-white main-header-content flex flex-col sm:grow gap-1 sm:gap-4 justify-center items-start order-1"},ie={class:"text-xs sm:text-base"},le={class:"text-xl sm:text-4xl lg:text-7xl font-circular-black text-left"},ae={class:"text-xs sm:text-base"},re={class:"font-circular-regular"},de={class:"flex-1 py-5 bg-zinc-900 bg-opacity-30 font-circular-thin bg-gradient-2"},ce={type:"button",class:"mx-4 sm:mx-8"},ge={class:"mx-4 sm:mx-8 mt-4"},he={id:"playlist",class:"w-full text-left"},ue={class:"border-b border-zinc-400 border-opacity-10 secondary-text"},me=e("th",{class:"hidden sm:table-cell px-4 sm:w-8 font-light"},"#",-1),fe={class:"sm:w-2/5 p-1 font-light"},_e={class:"hidden sm:table-cell w-1/3 font-light"},be={class:"hidden sm:table-cell w-1/5 font-light"},ye=e("th",{class:"hidden sm:table-cell w-2/12 font-light"},[e("div",{class:"flex justify-end mr-2 font-light"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"h-6 secondary-text","aria-label":"duration"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})])])],-1),pe={class:"text-white"},xe=e("tr",{class:"h-2"},null,-1),we={colspan:"5"},ke={key:0};function Se(t,n,s,f,h,o){const r=S("SongItem"),l=B("icon");return a(),c("main",Z,[e("section",ee,[e("h1",te,i(o.greeting()),1),e("div",se,[ne,e("div",oe,[e("h4",ie,i(t.$t("home.playlist")),1),e("h1",le,i(t.$t("home.liked")),1),e("p",ae,[e("span",re,i(t.username)+" ยบ "+i(s.songsCount)+" "+i(t.$t("home.songs")),1)])])])]),e("section",de,[e("button",ce,[R(e("i",{class:"text-[#1ed760] text-5xl bg-black rounded-full",onClick:n[0]||(n[0]=x(d=>t.playerHasSong?t.toggleAudio():t.play(this.songs[0]),["prevent"]))},null,512),[[l,t.playing?"pause-circle":"play-circle",void 0,{button:!0}]])]),e("div",ge,[e("table",he,[e("thead",ue,[e("tr",null,[me,e("th",fe,i(t.$t("home.title")),1),e("th",_e,i(t.$t("home.genre")),1),e("th",be,i(t.$t("home.comments")),1),ye])]),e("tbody",pe,[xe,(a(!0),c(E,null,H(s.songs,(d,I)=>(a(),P(r,{key:d.docID,song:d,index:I,"is-selected":o.isSongSelected(d.docID),onClick:A=>o.selectSong(d.docID),onDoubleClick:A=>o.handleDblClick(d)},null,8,["song","index","is-selected","onClick","onDoubleClick"]))),128))]),e("tfoot",null,[e("tr",null,[e("td",we,[s.songs.length===0?(a(),c("span",ke,i(t.$t("home.emptyPlaylist")),1)):z("",!0)])])])])])])])}const ve=k(X,[["render",Se]]),Ce={name:"Home",components:{AppPlaylist:ve},data(){return{songs:[],maxPerPage:10,pendingReq:!1,songsCount:0}},computed:{...u(D,["userLoggedIn"])},async created(){await this.getSongs(),await this.getSongsCount(),window.addEventListener("scroll",this.handleScroll)},methods:{async getSongs(){if(this.pendingReq||!this.userLoggedIn)return;this.pendingReq=!0;let t;if(this.songs.length){const n=await y.doc(this.songs[this.songs.length-1].docID).get();t=await y.where("uid","==",p.currentUser.uid).orderBy("modified_name").startAfter(n).limit(this.maxPerPage).get(),t.forEach(s=>{this.songs.push({docID:s.id,...s.data()})})}else t=await y.where("uid","==",p.currentUser.uid).orderBy("modified_name").limit(this.maxPerPage).get(),t.forEach(n=>{this.songs.push({docID:n.id,...n.data()})});this.pendingReq=!1},async getSongsCount(){this.userLoggedIn&&await N.doc(p.currentUser.uid).get().then(t=>{this.songsCount=t.data().songsCount??0}).catch(()=>{this.songsCount=0,console.error("Error getting user's songs count ")})},handleScroll(){const{scrollTop:t,offsetHeight:n}=document.documentElement,{innerHeight:s}=window;Math.ceil(t)+s>=n&&this.getSongs()}},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll)}};function De(t,n,s,f,h,o){const r=S("AppPlaylist");return a(),P(r,{songs:h.songs,songsCount:h.songsCount},null,8,["songs","songsCount"])}const Ie=k(Ce,[["render",De]]);export{Ie as default};
